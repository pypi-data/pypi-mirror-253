[tool.poetry]
name = "deci-common"
version = "13.1.1"
description = "A package for Deci's common data types, connections and interfaces"
authors = ["Deci AI <rnd@deci.ai>"]
readme = "README.md"
license = "Apache-2.0"
include = ["deci_common/auto_logging/auto_logging_conf.json"]

[tool.poetry.dependencies]
python = "^3.6.2"
boto3 = "^1.23.0"
botocore = "^1"
gdown = "^4"
numpy = "^1.19"
pydantic = "^1.9"
pymongo = "4.1.1"
python-json-logger = "2.0.2"
stringcase = "^1"

[tool.poetry.dev-dependencies]
bandit = { version = "^1.7.4", python = ">=3.7" }
black = { version = "^22.3.0", python = ">=3.7" }
coverage = { version = "6.2", extras = ["toml"] }
cryptography = "40.0.1"
fire = "0.5.0"
mypy = { version = "^1.3.0", python = ">=3.7", extras = ["reports"] }
numpy = { version = "^1.21", python = ">=3.7" }
pydantic = { version = "^1.10", python = ">=3.7" }
pydeps = "1.11.2"
pytest = [{ version = "^7.1.2", python = ">=3.7" }, { version = "7.0", python = ">=3.6.1,<3.7" }]
ruff = { version = "0.0.272", python = ">=3.7" }
tomli = { version = "^1", python = ">=3.6.1,<3.7" }
boto3-stubs = { version = "^1.23.0", extras = ["s3", "secretsmanager", "sqs", "sts"] }
botocore-stubs = "1.25.4"
types-requests = "2.27.25"
types-setuptools = "67.6.0.5"

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"

[tool.black]
line-length = 120

[tool.coverage.report]
fail_under = 64.64
precision = 2
skip_covered = true
skip_empty = true
exclude_lines = ["if TYPE_CHECKING:"]

[tool.mypy]
plugins = ["pydantic.mypy", "numpy.typing.mypy_plugin"]

warn_unused_configs = true
warn_redundant_casts = true
warn_unused_ignores = true
disallow_any_generics = true
check_untyped_defs = true
no_implicit_reexport = true

disallow_untyped_defs = true
disallow_incomplete_defs = true
disallow_untyped_calls = true
disallow_untyped_decorators = true

[tool.pydantic-mypy]
init_forbid_extra = true
init_typed = true
warn_required_dynamic_aliases = true
warn_untyped_fields = true

[[tool.mypy.overrides]]
module = "pymongo"
no_implicit_reexport = false

[tool.ruff]
extend-select = ["C90", "I", "ISC", "Q", "RSE", "TID", "TCH", "ERA", "PGH", "NPY", "RUF"]
ignore = ["E501"]
