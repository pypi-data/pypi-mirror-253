"use strict";(self["webpackChunkKalabash"]=self["webpackChunkKalabash"]||[]).push([[746],{7746:function(t,e,s){s.r(e),s.d(e,{default:function(){return x}});var n=s(4562),i=s(266),o=s(5495),l=(s(2838),s(573)),a=s(7808),r=s(7069),u=s(5352),c=s(4101),d=s(7678);const h=(0,d.Z)(l.Z);var p=h.extend().extend({name:"v-otp-input",directives:{ripple:r.Z},inheritAttrs:!1,props:{length:{type:[Number,String],default:6},type:{type:String,default:"text"},plain:Boolean},data:()=>({initialValue:null,isBooted:!1,otp:[]}),computed:{outlined(){return!this.plain},classes(){return{...l.Z.options.computed.classes.call(this),...a.Z.options.computed.classes.call(this),"v-otp-input--plain":this.plain}}},watch:{isFocused:"updateValue",value(t){this.lazyValue=t,this.otp=(null===t||void 0===t?void 0:t.split(""))||[]}},created(){var t;this.$attrs.hasOwnProperty("browser-autocomplete")&&(0,c.fK)("browser-autocomplete","autocomplete",this),this.otp=(null===(t=this.internalValue)||void 0===t?void 0:t.split(""))||[]},mounted(){requestAnimationFrame((()=>this.isBooted=!0))},methods:{focus(t,e){this.onFocus(t,e||0)},genInputSlot(t){return this.$createElement("div",this.setBackgroundColor(this.backgroundColor,{staticClass:"v-input__slot",style:{height:(0,u.kb)(this.height)},on:{click:()=>this.onClick(t),mousedown:e=>this.onMouseDown(e,t),mouseup:e=>this.onMouseUp(e,t)}}),[this.genDefaultSlot(t)])},genControl(t){return this.$createElement("div",{staticClass:"v-input__control"},[this.genInputSlot(t)])},genDefaultSlot(t){return[this.genFieldset(),this.genTextFieldSlot(t)]},genContent(){return Array.from({length:+this.length},((t,e)=>this.$createElement("div",this.setTextColor(this.validationState,{staticClass:"v-input",class:this.classes}),[this.genControl(e)])))},genFieldset(){return this.$createElement("fieldset",{attrs:{"aria-hidden":!0}},[this.genLegend()])},genLegend(){const t=this.$createElement("span",{domProps:{innerHTML:"&#8203;"}});return this.$createElement("legend",{style:{width:"0px"}},[t])},genInput(t){const e=Object.assign({},this.listeners$);return delete e.change,this.$createElement("input",{style:{},domProps:{value:this.otp[t],min:"number"===this.type?0:null},attrs:{...this.attrs$,autocomplete:"one-time-code",disabled:this.isDisabled,readonly:this.isReadonly,type:this.type,id:`${this.computedId}--${t}`,class:`otp-field-box--${t}`},on:Object.assign(e,{blur:this.onBlur,input:e=>this.onInput(e,t),focus:e=>this.onFocus(e,t),keydown:this.onKeyDown,keyup:e=>this.onKeyUp(e,t)}),ref:"input",refInFor:!0})},genTextFieldSlot(t){return this.$createElement("div",{staticClass:"v-text-field__slot"},[this.genInput(t)])},onBlur(t){this.isFocused=!1,t&&this.$nextTick((()=>this.$emit("blur",t)))},onClick(t){this.isFocused||this.isDisabled||!this.$refs.input[t]||this.onFocus(void 0,t)},onFocus(t,e){null===t||void 0===t||t.preventDefault(),null===t||void 0===t||t.stopPropagation();const s=this.$refs.input,n=this.$refs.input&&s[e||0];if(n)return document.activeElement!==n?(n.focus(),n.select()):void(this.isFocused||(this.isFocused=!0,n.select(),t&&this.$emit("focus",t)))},onInput(t,e){const s=+this.length-1,n=t.target,i=n.value,o=(null===i||void 0===i?void 0:i.split(""))||[],l=[...this.otp];for(let a=0;a<o.length;a++){const t=e+a;if(t>s)break;l[t]=o[a].toString()}o.length||l.splice(e,1),this.otp=l,this.internalValue=this.otp.join(""),e+o.length>=+this.length?(this.onCompleted(),this.clearFocus(e)):o.length&&this.changeFocus(e+o.length)},clearFocus(t){const e=this.$refs.input[t];e.blur()},onKeyDown(t){t.keyCode===u.Do.enter&&this.$emit("change",this.internalValue),this.$emit("keydown",t)},onMouseDown(t,e){t.target!==this.$refs.input[e]&&(t.preventDefault(),t.stopPropagation()),l.Z.options.methods.onMouseDown.call(this,t)},onMouseUp(t,e){this.hasMouseDown&&this.focus(t,e),l.Z.options.methods.onMouseUp.call(this,t)},changeFocus(t){this.onFocus(void 0,t||0)},updateValue(t){this.hasColor=t,t?this.initialValue=this.lazyValue:this.initialValue!==this.lazyValue&&this.$emit("change",this.lazyValue)},onKeyUp(t,e){t.preventDefault();const s=t.key;if(!["Tab","Shift","Meta","Control","Alt"].includes(s)&&!["Delete"].includes(s))return"ArrowLeft"===s||"Backspace"===s&&!this.otp[e]?e>0&&this.changeFocus(e-1):"ArrowRight"===s?e+1<+this.length&&this.changeFocus(e+1):void 0},onCompleted(){const t=this.otp.join("");t.length===+this.length&&this.$emit("finish",t)}},render(t){return t("div",{staticClass:"v-otp-input",class:this.themeClasses},this.genContent())}}),f=s(1713),g=function(){var t=this,e=t._self._c;return e(f.Z,{staticStyle:{height:"100%",margin:"0 auto"}},[e(i.Z,{staticClass:"primary",staticStyle:{height:"100%"},attrs:{cols:"0",sm:"6"}},[e(o.Z,{staticClass:"mt-10 ml-8",attrs:{src:s(5238),"max-width":"300"}})],1),e(i.Z,{staticClass:"d-flex flex-column justify-center pa-10",attrs:{cols:"12",sm:"6"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.verifyCode.apply(null,arguments)}}},[e("span",{staticClass:"primary--text mb-6 text-h4"},[e("translate",[t._v("Verification")])],1),e("validation-observer",{ref:"observer"},[e("validation-provider",{attrs:{vid:"code",name:"code",rules:"required"},scopedSlots:t._u([{key:"default",fn:function({errors:s}){return[e(f.Z,[e(i.Z,{attrs:{cols:"6",offset:"3"}},[e("label",{staticClass:"m-label"},[e("translate",[t._v("Two-factor authentication code")])],1),e(p,{ref:"otpInput",attrs:{length:"6","error-messages":s,hint:t._f("translate")("Enter the code from the two-factor app on your mobile device. If you have lost your device, you may enter one of your recovery codes."),"persistent-hint":""},on:{finish:t.verifyCode},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1)],1)]}}])})],1),e("div",{staticClass:"d-flex justify-center mt-6"},[e(n.Z,{staticClass:"flex-grow-1",attrs:{color:"primary",large:"",loading:t.loading},on:{click:t.verifyCode}},[e("translate",[t._v("Verify code")])],1)],1)],1)],1)},y=[],m=(s(7658),s(5282)),v=s(6808),C=s.n(v),b=s(2257),$={data(){return{code:null,errors:{},loading:!1}},mounted:function(){this.$refs.otpInput.focus()},methods:{async verifyCode(){const t=await this.$refs.observer.validate();t&&(this.loading=!0,b.Z.verifyTFACode(this.code).then((t=>{C().set("token",t.data.access,{sameSite:"strict"}),C().set("refreshToken",t.data.refresh,{sameSite:"strict"}),this.$store.dispatch("auth/initialize").then((()=>{m.$.$emit("loggedIn"),this.$router.push({name:"DomainList"})}))})).catch((t=>{this.$refs.observer.setErrors(t.response.data),this.loading=!1})))}}},S=$,k=s(1001),w=(0,k.Z)(S,g,y,!1,null,null,null),x=w.exports},266:function(t,e,s){s(7658),s(1884);var n=s(144),i=s(1767),o=s(5352);const l=["sm","md","lg","xl"],a=(()=>l.reduce(((t,e)=>(t[e]={type:[Boolean,String,Number],default:!1},t)),{}))(),r=(()=>l.reduce(((t,e)=>(t["offset"+(0,o.jC)(e)]={type:[String,Number],default:null},t)),{}))(),u=(()=>l.reduce(((t,e)=>(t["order"+(0,o.jC)(e)]={type:[String,Number],default:null},t)),{}))(),c={col:Object.keys(a),offset:Object.keys(r),order:Object.keys(u)};function d(t,e,s){let n=t;if(null!=s&&!1!==s){if(e){const s=e.replace(t,"");n+=`-${s}`}return"col"!==t||""!==s&&!0!==s?(n+=`-${s}`,n.toLowerCase()):n.toLowerCase()}}const h=new Map;e["Z"]=n.ZP.extend({name:"v-col",functional:!0,props:{cols:{type:[Boolean,String,Number],default:!1},...a,offset:{type:[String,Number],default:null},...r,order:{type:[String,Number],default:null},...u,alignSelf:{type:String,default:null,validator:t=>["auto","start","end","center","baseline","stretch"].includes(t)},tag:{type:String,default:"div"}},render(t,{props:e,data:s,children:n,parent:o}){let l="";for(const i in e)l+=String(e[i]);let a=h.get(l);if(!a){let t;for(t in a=[],c)c[t].forEach((s=>{const n=e[s],i=d(t,s,n);i&&a.push(i)}));const s=a.some((t=>t.startsWith("col-")));a.push({col:!s||!e.cols,[`col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),h.set(l,a)}return t(e.tag,(0,i.ZP)(s,{class:a}),n)}})},1713:function(t,e,s){s(7658),s(1884);var n=s(144),i=s(1767),o=s(5352);const l=["sm","md","lg","xl"],a=["start","end","center"];function r(t,e){return l.reduce(((s,n)=>(s[t+(0,o.jC)(n)]=e(),s)),{})}const u=t=>[...a,"baseline","stretch"].includes(t),c=r("align",(()=>({type:String,default:null,validator:u}))),d=t=>[...a,"space-between","space-around"].includes(t),h=r("justify",(()=>({type:String,default:null,validator:d}))),p=t=>[...a,"space-between","space-around","stretch"].includes(t),f=r("alignContent",(()=>({type:String,default:null,validator:p}))),g={align:Object.keys(c),justify:Object.keys(h),alignContent:Object.keys(f)},y={align:"align",justify:"justify",alignContent:"align-content"};function m(t,e,s){let n=y[t];if(null!=s){if(e){const s=e.replace(t,"");n+=`-${s}`}return n+=`-${s}`,n.toLowerCase()}}const v=new Map;e["Z"]=n.ZP.extend({name:"v-row",functional:!0,props:{tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:u},...c,justify:{type:String,default:null,validator:d},...h,alignContent:{type:String,default:null,validator:p},...f},render(t,{props:e,data:s,children:n}){let o="";for(const i in e)o+=String(e[i]);let l=v.get(o);if(!l){let t;for(t in l=[],g)g[t].forEach((s=>{const n=e[s],i=m(t,s,n);i&&l.push(i)}));l.push({"no-gutters":e.noGutters,"row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),v.set(o,l)}return t(e.tag,(0,i.ZP)(s,{staticClass:"row",class:l}),n)}})}}]);
//# sourceMappingURL=746.823c5ba6.js.map