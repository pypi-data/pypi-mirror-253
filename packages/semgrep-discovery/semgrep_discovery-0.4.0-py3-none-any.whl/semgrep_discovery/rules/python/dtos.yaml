rules:
  - id: django-data-object
    message: Django db `Table $OBJECT, field $FIELD, type $TYPE`
    languages: [python]
    severity: INFO
    patterns:
    - pattern-inside: |
        class $OBJECT(...):
          ...
    - pattern: $FIELD = django.db.models.$TYPE(...)
  - id: sqlalchemy-data-object
    message: sqlalchemy db `Object $OBJECT, field $FIELD, type $TYPE`
    languages: [python]
    severity: INFO
    patterns:
    - pattern-inside: |
        class $CLASS(db.Model):
          ...
          __tablename__ = $OBJECT
          ...
    - pattern-either:
      - pattern: $FIELD = db.Column($TYPE, ...)
      - pattern: $FIELD = db.relationship($TYPE, ...)
  - id: mongo-data-object
    message: mongo db `Object $OBJECT, field $FIELD, type $TYPE`
    languages: [python]
    severity: INFO
    patterns:
    - pattern-either:
      - pattern-inside: |
          class $OBJECT(..., addappter.components.mongoengine.$DOCTYPE, ...):
      - pattern-inside: |
          class $OBJECT(..., mongoengine.$DOCTYPE, ...):
    - pattern-either:
      - pattern: $FIELD = mongoengine.fields.$TYPE(...)
      - pattern: $FIELD = mongoengine.$TYPE(...)