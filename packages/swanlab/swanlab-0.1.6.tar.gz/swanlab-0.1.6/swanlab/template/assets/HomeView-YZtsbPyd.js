import{_ as e,D as t,a}from"./SLStatusLabel-kRnitJQs.js";import{_ as l,u as s,i as r,c as o,o as n,a as u,b as i,n as c,d,t as p,e as v,f as m,r as f,h,m as y,g as b,w as x,j as w,R as g,k,l as _,p as $,F as j,q as S,s as E,v as L,x as B,y as T,z as A,S as M,A as C,B as H,C as I,D as R,E as U,G as W,H as z}from"./index-4sXZTXMQ.js";import"./SLLoading-q9AnJLts.js";const q={class:"w-full h-full pt-5 flex flex-col"},D={class:"px-6 border-b flex-shrink-0"},G={class:"flex items-center gap-3"},N={class:"text-2xl items-center gap-1 font-semibold max-w-md truncate"},O={key:0,class:"project-description"},P=l({__name:"HomeLayout",setup(a){const l=s(),b=r("isSideBarShow"),x=async(e,t)=>{const{data:a}=await h.patch("/project/update",e);l.updateInfo(a.updates),t()},w=o((()=>{for(const e of l.experiments)if(0===e.status)return!0;return!1})),g=()=>{h.delete("/project").then((()=>{y.success("Delete Successfully"),location.reload()})).catch((()=>{y.error("Error deleting project")}))};return(a,s)=>{const r=e,o=t;return n(),u("div",q,[i("div",D,[i("div",{class:c(["project-title transition-marging duration-300",{"ml-8":!d(b)}])},[i("div",G,[i("h1",N,p(d(l).name),1),v(r,{type:"project",onModify:x})]),i("div",{class:c(["flex justify-end grow transition-padding duration-300 ml-1",{"pr-8":!d(b)}])},[v(o,{type:"project",onConfirm:g,disabled:w.value},null,8,["disabled"])],2)],2),d(l).description?(n(),u("p",O,p(d(l).description),1)):m("",!0),f(a.$slots,"top",{},void 0,!0)]),f(a.$slots,"default",{},void 0,!0)])}}},[["__scopeId","data-v-720215c4"]]),X=["title"],F={__name:"ExperimentName",props:{name:{type:String,required:!0},color:{type:String,required:!0},id:{required:!0}},setup:e=>(t,a)=>(n(),b(d(g),{class:"flex gap-2 items-center w-full",to:`/experiment/${e.id}`},{default:x((()=>[i("circle",{class:"w-3 h-3 rounded-full flex-shrink-0",style:w({backgroundColor:t.$props.color})},null,4),i("p",{class:"truncate",title:e.name},p(e.name),9,X)])),_:1},8,["to"]))},V={class:"border-y flex bg-higher table-header"},J=["onMouseover"],K=["title"],Q=["onMousedown"],Y=["title","onMouseover"],Z={key:0,class:"w-full overflow-hidden"},ee={key:1,class:"w-full overflow-hidden"},te={key:0,class:"flex justify-center py-3 border border-t-0"},ae={class:"data-empty"},le=l({__name:"ExprTable",props:{data:{type:Array,default:()=>[]},column:{type:Array,default:()=>[]},maxW:{type:String,default:"none"},highLight:{type:Boolean,default:!0},flexable:{type:Boolean,default:!1},lastRowGradient:{type:Boolean,default:!1},tableBorder:{type:Boolean,default:!1},stickyHeader:{type:Boolean,default:!1}},setup(e){const t=e,a=k(null),l=k([]),s=k(null),d=k(null),v=k("100%"),h=o((()=>{if(t.flexable){const e=t.column.length;return new Array(e).fill(1/e*100+"%")}return l.value.map((e=>(null==e?void 0:e.value)?(null==e?void 0:e.value)+"px":""))})),y=k(-1),b=o((()=>-1===E.value?y.value:E.value));_((()=>{t.column.forEach(((e,t)=>{if(l.value[t]={value:0,extended:!1},e.width){const a=e.width>150?e.width:150;l.value[t].value=e.border?a-2:a}else l.value[t].value=150})),x(),window.addEventListener("resize",x)}));const x=()=>{let e=0;l.value.forEach((({value:t})=>{e+=t})),d.value.offsetWidth>e?d.value.offsetWidth&&(v.value=d.value.offsetWidth):v.value=e},g=r("isSideBarShow");$(g,(e=>{t.flexable||(e?v.value-=288:v.value+=288)}));const E=k(-1),L=k(0),B=k(0),T=k(70),A=e=>{let t=B.value+(e.clientX-L.value);t=t<T.value?T.value:t,l.value[E.value].value=t,a.value[E.value]=t},M=()=>{x(),document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",M),document.body.style.userSelect="auto",document.body.style.cursor="",L.value=0,B.value=0,E.value=-1},C=e=>{y.value=e};return(t,r)=>(n(),u("div",{class:"w-full",ref_key:"wrapper",ref:d},[i("div",{class:c({"gradient-last-line":e.lastRowGradient,"table-border":e.tableBorder}),style:w({width:"string"==typeof v.value?v.value:`${v.value}px`}),ref_key:"table",ref:s},[i("div",{class:c({"sticky top-0 z-20":e.stickyHeader})},[i("div",V,[(n(!0),u(j,null,S(e.column,((t,s)=>(n(),u("div",{key:t.key,class:c(["cell table-header-item",b.value===s?"bg-highest":"bg-higher"]),onMouseover:e=>C(s),onMouseout:r[0]||(r[0]=e=>C(-1)),style:w({width:h.value[s]}),ref_for:!0,ref_key:"columnsRef",ref:a},[i("p",{class:c(["overflow-hidden w-full h-full flex items-center",t.style||"px-2 py-3"]),title:t.title},p(t.title),11,K),e.column.unresizeable||e.flexable?m("",!0):(n(),u("button",{key:0,onMousedown:e=>((e,t)=>{document.body.style.userSelect="none",document.body.style.cursor="col-resize",E.value=t,L.value=e.clientX,h.value[t].endsWith("%")&&(l.value[t].value=a.value[t].offsetWidth),B.value=l.value[t].value,document.addEventListener("mousemove",A),document.addEventListener("mouseup",M)})(e,s),class:c({"button-hover-tip":y.value===s})},null,42,Q))],46,J)))),128))])],2),(n(!0),u(j,null,S(e.data,((a,l)=>(n(),u("div",{key:a,class:c([{"hover:bg-higher":-1===E.value},"line"])},[(n(!0),u(j,null,S(e.column,((e,s)=>(n(),u("div",{key:e.key,title:a[e.key],class:c(["cell flex items-center px-2 py-3",[e.style,{"hover:bg-primary-dimmest":-1===E.value},b.value===s?"bg-higher":"bg-default"]]),onMouseover:e=>C(s),onMouseout:r[1]||(r[1]=e=>C(-1)),style:w({width:h.value[s]})},[e.slot?(n(),u("div",Z,[f(t.$slots,e.slot,{row:a,index:l},void 0,!0)])):(n(),u("div",ee,p(a[e.key]||"-"),1))],46,Y)))),128))],2)))),128)),e.data.length?m("",!0):(n(),u("div",te,[i("div",ae,p(t.$t("common.table.empty")),1)]))],6)],512))}},[["__scopeId","data-v-12dc72b0"]]),se={class:"flex-col justify-center items-center pt-10"},re=(e=>(E("data-v-bcdae545"),e=e(),L(),e))((()=>i("div",{class:"loader"},null,-1))),oe={class:"text-center pt-10 text-lg"},ne=l({__name:"EmptyTable",setup:e=>(e,t)=>(n(),u("div",se,[re,i("p",oe,p(e.$t("home.empty.table")),1)]))},[["__scopeId","data-v-bcdae545"]]),ue=["checked"],ie={class:"select-none truncate"},ce={__name:"SLCheck",props:{label:{type:String,default:""},checked:{type:Boolean,default:!1}},emits:["update:checked"],setup:e=>(t,a)=>(n(),u("div",{class:"flex items-center gap-2 cursor-pointer",onClick:a[0]||(a[0]=a=>t.$emit("update:checked",!e.checked))},[i("input",{type:"checkbox",class:"border cursor-pointer w-4 h-4",checked:e.checked},null,8,ue),i("span",ie,p(e.label),1)]))},de={class:"w-full flex justify-between items-center"},pe={class:"flex gap-5 items-center pl-10"},ve={__name:"TableBar",props:{tableBody:{type:Array,default:()=>[]},tableHead:{type:Array,default:()=>[]},checked:{type:Boolean,default:!1},searchText:{type:String,default:""}},emits:["update:checked","update:searchText"],setup(e){const t=(e,t,a)=>{switch(t){case"config":return e.config[a]?e.config[a].value:"-";case"create_time":return A(e.create_time);case"status":return T(`experiment.status.${e.status}`)}};return(a,l)=>{const s=M,r=C,o=H;return n(),u("div",de,[v(s,{class:"max-w-[400px]",onInput:l[0]||(l[0]=e=>a.$emit("update:searchText",e)),placeholder:a.$t("experiment.index.header.table-bar.placeholder")},null,8,["placeholder"]),i("div",pe,[v(ce,{label:a.$t("experiment.index.header.table-bar.summary"),checked:e.checked,"onUpdate:checked":l[1]||(l[1]=e=>a.$emit("update:checked",e))},null,8,["label","checked"]),v(o,{theme:"default",class:"px-3 py-2 rounded-lg flex items-center gap-2",onClick:l[2]||(l[2]=a=>function(e,a){if(!(e&&a&&Array.isArray(e)&&Array.isArray(a)&&e.length&&a.length))return;let{year:l,month:s,day:r,hour:o,minute:n,second:u}=B((new Date).getTime()-288e5);const i=`swanlab_experiments_${l}-${s}-${r}_${o}-${n}-${u}.csv`;var c="data:text/csv;charset=utf-8,\ufeff";const d=e.map((e=>e.title)).join(",");c+=d+"\n",a.forEach(((l,s)=>{let r="";for(let a=0;a<e.length;a++){const s=e[a],o=s.key||s.slot;r+=(s.type?t(l,s.type,o):l[o]||"-")+","}c+=s<a.length?r.replace(/,$/,"\n"):r.replace(/,$/,"")}));const p=document.createElement("a");p.href=encodeURI(c),p.download=i,p.click(),window.URL.revokeObjectURL(c)}(e.tableHead,e.tableBody)),hollow:""},{default:x((()=>[v(r,{icon:"download",class:"w-4 h-4"}),i("span",null,p(a.$t("experiment.index.header.table-bar.export")),1)])),_:1})])])}}},me={class:"w-80 flex flex-col gap-4 my-5 text-dimmer"},fe={class:"flex justify-between"},he={class:"grow"},ye={class:"w-36 whitespace-nowrap"},be={class:"flex justify-between"},xe={class:"grow"},we={class:"w-36 whitespace-nowrap"},ge={class:"flex justify-between"},ke={class:"grow"},_e={class:"w-36 whitespace-nowrap"},$e={class:"pt-5 flex flex-col flex-grow flex-shrink-0"},je={class:"flex mx-6 mb-4 items-center gap-1.5 flex-shrink-0"},Se={class:"text-xl font-semibold"},Ee={key:0,class:"bg-positive-dimmest text-positive-higher rounded-full px-3"},Le={key:0,class:"w-full pb-10 flex flex-col overflow-scroll flex-grow basis-0"},Be=l({__name:"HomeView",setup(e){const t=s(),l=o((()=>void 0===t.experiments?[]:t.experiments)),r=o((()=>A(t.createTime))),c=o((()=>A(t.updateTime))),f=o((()=>{var e;return(null==(e=t.experiments)?void 0:e.length)||0})),y=k([{title:T("home.list.table.header.name"),slot:"name",style:"px-6",width:300,border:!0},{title:T("home.list.table.header.status"),slot:"status",type:"status"},{title:T("home.list.table.header.create"),slot:"create",type:"create_time"}]),w=k([]);l.value.map((e=>{Object.entries(e.config).forEach((([e])=>{w.value.some((t=>t.title===e))||w.value.push({type:"config",slot:e,title:e})}))}));const g=o((()=>l.value.map((e=>{const t=$.value[e.name];return t?(Promise.all(Object.keys(t).map((async a=>{e[await j(a)]=isNaN(t[a])?t[a]:z(t[a])}))),e):{}})))),_=k(),$=k({});async function j(e){return"swanlab-overview-table-key"+e}h.get("/project/summaries",{params:{experiment_names:(()=>{let e=[];return l.value.forEach((t=>{e.push(t.name)})),e.join(",")})()}}).then((async({data:e})=>{_.value=await Promise.all(e.tags.map((async e=>({key:await j(e),title:e})))),$.value=e.summaries}));const E=k(!1),L=o((()=>E.value?[y.value[0],..._.value]:[...y.value,...w.value,..._.value||[]])),B=k(""),M=o((()=>B.value?g.value.filter((e=>e.name.toLowerCase().includes(B.value.toLowerCase()))):g.value));return(e,s)=>{const o=P;return n(),b(o,null,{top:x((()=>[i("div",me,[i("div",fe,[i("div",he,p(e.$t("home.overview.create")),1),i("p",ye,p(r.value),1)]),i("div",be,[i("div",xe,p(e.$t("home.overview.latest")),1),i("p",we,p(c.value),1)]),i("div",ge,[i("div",ke,p(e.$t("home.overview.logdir")),1),i("p",_e,p(d(t).logdir),1)])])])),default:x((()=>[i("div",$e,[i("div",je,[i("h2",Se,p(e.$t("home.list.title")),1),f.value?(n(),u("span",Ee,p(f.value),1)):m("",!0)]),v(ve,{class:"pb-4 pt-1 px-5 flex-shrink-0","table-head":L.value,"table-body":M.value,searchText:B.value,checked:E.value,"onUpdate:checked":s[0]||(s[0]=e=>E.value=e),"onUpdate:searchText":s[1]||(s[1]=e=>B.value=e)},null,8,["table-head","table-body","searchText","checked"]),_.value?(n(),u("div",Le,[v(le,{"sticky-header":"",class:"dashboard-table",column:L.value,data:M.value,"last-row-gradient":""},I({name:x((({row:e})=>{return[v(F,{name:e.name,id:e.id,color:(t=e,t.light)},null,8,["name","id","color"])];var t})),status:x((({row:e})=>[v(a,{id:e.experiment_id,status:e.status},null,8,["id","status"])])),create:x((({row:e})=>[R(p(d(U)(d(W)(e.create_time))),1)])),_:2},[S(w.value,(e=>({name:e.slot,fn:x((({row:t})=>{var a;return[R(p((null==(a=t.config[e.slot])?void 0:a.value)||"-"),1)]}))})))]),1032,["column","data"])])):0===l.value.length?(n(),b(ne,{key:1})):m("",!0)])])),_:1})}}},[["__scopeId","data-v-d9dd789a"]]);export{Be as default};
