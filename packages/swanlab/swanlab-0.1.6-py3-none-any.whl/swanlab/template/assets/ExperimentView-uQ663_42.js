import{_ as e,I as t,u as a,J as s,k as n,i,y as r,K as l,o as d,a as o,b as m,n as p,d as u,t as c,e as x,r as v,f as h,F as b,q as g,w as f,D as _,h as y,m as w,A as I,c as S,L as $,M as E,g as k,N as L,O as R}from"./index-4sXZTXMQ.js";import{_ as j,D,a as N}from"./SLStatusLabel-kRnitJQs.js";import"./SLLoading-q9AnJLts.js";const B={class:"w-full h-full py-5 relative"},C={class:"px-6 border-b"},M={class:"flex items-center gap-3"},P={class:"text-2xl items-center gap-1 truncate max-w-sm sm:max-w-lg 2xl:max-w-5xl"},q={class:"font-semibold"},A={key:0,class:"experiment-description"},F={class:"experiment-navs"},J={class:"w-full overflow-y-auto pb-10"},K=e({__name:"ExperimentLayout",setup(e){const S=t(),$=a(),E=s(),k=n(E.experiment),L=i("isSideBarShow"),R=()=>{y.delete(`/experiment/${E.id}`).then((({data:e})=>{$.deleteExperiment(e.experiment_id),S.replace("/").then((()=>{w.success("Delete Successfully")}))})).catch((({data:e})=>{w.error(e.message)}))},K=async(e,t)=>{const a=E.id,{data:s}=await y.patch(`/experiment/${a}`,e);E.setExperimentPartial(s),$.setExperimentInfo(a,e),t()},O=[{label:r("experiment.navs.index"),to:`/experiment/${E.id}/index`,icon:"experiment"},{label:r("experiment.navs.chart"),to:`/experiment/${E.id}/chart`,icon:"charts"},{label:r("experiment.navs.log"),to:`/experiment/${E.id}/log`,icon:"logs"},{label:r("experiment.navs.env"),to:`/experiment/${E.id}/env`,icon:"info"}];return(e,t)=>{const a=N,s=I,n=l("RouterLink");return d(),o("div",B,[m("div",C,[m("div",{class:p(["experiment-title transition-marging duration-300",{"ml-8":!u(L)}])},[m("div",M,[m("h1",P,[m("span",q,c(u(E).name),1)]),x(j,{type:"experiment",onModify:K,disabled:u(E).isRunning},null,8,["disabled"]),x(a,{name:k.value.name,id:k.value.id,status:k.value.status},null,8,["name","id","status"]),u(E).isRunning?v(e.$slots,"stop-button",{key:0},void 0,!0):h("",!0)]),m("div",{class:p(["flex justify-end grow transition-padding duration-300 ml-1",{"pr-8":!u(L)}])},[x(D,{type:"experiment",disabled:u(E).isRunning,onConfirm:R},null,8,["disabled"])],2)],2),u(E).description?(d(),o("p",A,c(u(E).description),1)):h("",!0),m("nav",F,[(d(),o(b,null,g(O,(e=>x(n,{class:"nav-item","active-class":"nav-active","data-text":e.label,key:e.to,to:e.to},{default:f((()=>[x(s,{icon:e.icon,class:"w-5 h-5"},null,8,["icon"]),_(" "+c(e.label),1)])),_:2},1032,["data-text","to"]))),64))])]),m("div",J,[v(e.$slots,"default",{},void 0,!0)])])}}},[["__scopeId","data-v-f2928340"]]),O={__name:"StopButton",setup(e){const t=s(),n=t.id,i=t.status,l=S((()=>0===i)),m=()=>{$(r("experiment.index.header.stop.modal.title"),r("experiment.index.header.stop.modal.text"),r("experiment.index.header.stop.button")).then(u)},u=async()=>{const{data:e}=await y.get(`/experiment/${n}/stop`);e&&(t.setExperimentPartial({update_time:e.update_time,status:e.status}),a().setExperimentStatus(n,-1),w.success("State changed"))};return(e,t)=>(d(),o("button",{class:p(["underline text-dimmest ml-2",l.value?"":"cursor-not-allowed"]),onClick:m}," is over? ",2))}},T={__name:"ExperimentView",setup(e){const t=R(),i=s(),r=a(),m=S((()=>void 0!==i.id)),p=n(0),c=async(e=t.params.experimentId)=>{i.experiment=void 0,i.charts=void 0,y.get(`/experiment/${e}`).then((({data:e})=>{i.experiment=e,r.setExperimentStatus(e.id,e.status,e.update_time),i.isRunning&&g()})).catch((e=>{var t;p.value=(null==(t=e.data)?void 0:t.code)||3e3}))};c(),E(((e,t)=>{e.params.experimentId!==t.params.experimentId&&(c(e.params.experimentId),clearInterval(v))}));let v=null;const g=()=>{v=setInterval((()=>{y.get(`/experiment/${i.id}/status`).then((({data:e})=>{Number(i.id)===Number(t.params.experimentId)?(i.setStatus(e.status),i.setUpateTime(e.update_time),r.setExperimentStatus(i.id,e.status,e.update_time),i.charts=e.charts,i.isRunning||clearInterval(v)):clearInterval(v)}))}),1e3)};return(e,t)=>{const a=l("router-view");return d(),o(b,null,[m.value?(d(),k(K,{key:u(i).id},{"stop-button":f((()=>[x(O)])),default:f((()=>[x(a)])),_:1})):h("",!0),!m.value&&p.value?(d(),k(L,{key:1,code:p.value},null,8,["code"])):h("",!0)],64)}}};export{T as default};
