"use strict";(self.webpackChunk_datalayer_jupyter_kernels=self.webpackChunk_datalayer_jupyter_kernels||[]).push([[9560],{19560:(e,t,s)=>{s.r(t),s.d(t,{FigureModel:()=>d,FigureView:()=>y,MODULE_NAME:()=>n.o,MODULE_VERSION:()=>n.Y});var a=s(37731),l=s(92891),o=s.n(l),i=s(33091),r=s.n(i),n=s(94032);window.PlotlyConfig={MathJaxConfig:"local"};const _="^"+n.Y;class d extends a.DOMWidgetModel{defaults(){return{...super.defaults(),_model_name:d.model_name,_model_module:d.model_module,_model_module_version:d.model_module_version,_view_name:d.view_name,_view_module:d.view_module,_view_module_version:d.view_module_version,_data:[],_layout:{},_config:{},_py2js_addTraces:null,_py2js_deleteTraces:null,_py2js_moveTraces:null,_py2js_restyle:null,_py2js_relayout:null,_py2js_update:null,_py2js_animate:null,_py2js_removeLayoutProps:null,_py2js_removeTraceProps:null,_js2py_restyle:null,_js2py_relayout:null,_js2py_update:null,_js2py_layoutDelta:null,_js2py_traceDeltas:null,_js2py_pointsCallback:null,_last_layout_edit_id:0,_last_trace_edit_id:0}}initialize(){super.initialize.apply(this,arguments),this.on("change:_data",this.do_data,this),this.on("change:_layout",this.do_layout,this),this.on("change:_py2js_addTraces",this.do_addTraces,this),this.on("change:_py2js_deleteTraces",this.do_deleteTraces,this),this.on("change:_py2js_moveTraces",this.do_moveTraces,this),this.on("change:_py2js_restyle",this.do_restyle,this),this.on("change:_py2js_relayout",this.do_relayout,this),this.on("change:_py2js_update",this.do_update,this),this.on("change:_py2js_animate",this.do_animate,this),this.on("change:_py2js_removeLayoutProps",this.do_removeLayoutProps,this),this.on("change:_py2js_removeTraceProps",this.do_removeTraceProps,this)}_normalize_trace_indexes(e){if(null==e){const t=this.get("_data").length;e=o().range(t)}return Array.isArray(e)||(e=[e]),e}do_data(){}do_layout(){}do_addTraces(){const e=this.get("_py2js_addTraces");if(null!==e){const t=this.get("_data"),s=e.trace_data;o().forEach(s,(e=>{t.push(e)}))}}do_deleteTraces(){const e=this.get("_py2js_deleteTraces");if(null!==e){const t=e.delete_inds,s=this.get("_data");t.slice().reverse().forEach((e=>{s.splice(e,1)}))}}do_moveTraces(){const e=this.get("_py2js_moveTraces");null!==e&&function(e,t,s){let a=[];for(let s=t.length-1;s>=0;s--)a.splice(0,0,e[t[s]]),e.splice(t[s],1);const l=o()(s).zip(a).sortBy(0).unzip().value();s=l[0],a=l[1];for(let t=0;t<s.length;t++)e.splice(s[t],0,a[t])}(this.get("_data"),e.current_trace_inds,e.new_trace_inds)}do_restyle(){const e=this.get("_py2js_restyle");if(null!==e){const t=e.restyle_data,s=this._normalize_trace_indexes(e.restyle_traces);m(this.get("_data"),t,s)}}do_relayout(){const e=this.get("_py2js_relayout");null!==e&&f(this.get("_layout"),e.relayout_data)}do_update(){const e=this.get("_py2js_update");if(null!==e){const t=e.style_data,s=e.layout_data,a=this._normalize_trace_indexes(e.style_traces);m(this.get("_data"),t,a),f(this.get("_layout"),s)}}do_animate(){const e=this.get("_py2js_animate");if(null!==e){const t=e.style_data,s=e.layout_data,a=this._normalize_trace_indexes(e.style_traces);for(let e=0;e<t.length;e++){const s=t[e],l=a[e];f(this.get("_data")[l],s)}f(this.get("_layout"),s)}}do_removeLayoutProps(){const e=this.get("_py2js_removeLayoutProps");if(null!==e){const t=e.remove_props;g(this.get("_layout"),t)}}do_removeTraceProps(){const e=this.get("_py2js_removeTraceProps");if(null!==e){const t=e.remove_props,s=e.remove_trace;g(this.get("_data")[s],t)}}static serializers={...a.DOMWidgetModel.serializers,_data:{deserialize:h,serialize:u},_layout:{deserialize:h,serialize:u},_py2js_addTraces:{deserialize:h,serialize:u},_py2js_deleteTraces:{deserialize:h,serialize:u},_py2js_moveTraces:{deserialize:h,serialize:u},_py2js_restyle:{deserialize:h,serialize:u},_py2js_relayout:{deserialize:h,serialize:u},_py2js_update:{deserialize:h,serialize:u},_py2js_animate:{deserialize:h,serialize:u},_py2js_removeLayoutProps:{deserialize:h,serialize:u},_py2js_removeTraceProps:{deserialize:h,serialize:u},_js2py_restyle:{deserialize:h,serialize:u},_js2py_relayout:{deserialize:h,serialize:u},_js2py_update:{deserialize:h,serialize:u},_js2py_layoutDelta:{deserialize:h,serialize:u},_js2py_traceDeltas:{deserialize:h,serialize:u},_js2py_pointsCallback:{deserialize:h,serialize:u}};static model_name="FigureModel";static model_module=n.o;static model_module_version=_;static view_name="FigureView";static view_module=n.o;static view_module_version=_}class y extends a.DOMWidgetView{viewID;perform_render(){const e=this;this.model.on("change:_py2js_addTraces",this.do_addTraces,this),this.model.on("change:_py2js_deleteTraces",this.do_deleteTraces,this),this.model.on("change:_py2js_moveTraces",this.do_moveTraces,this),this.model.on("change:_py2js_restyle",this.do_restyle,this),this.model.on("change:_py2js_relayout",this.do_relayout,this),this.model.on("change:_py2js_update",this.do_update,this),this.model.on("change:_py2js_animate",this.do_animate,this),window.MathJax&&window.MathJax.Hub.Config({SVG:{font:"STIX-Web"}});const t=this.model.get("_last_layout_edit_id"),s=this.model.get("_last_trace_edit_id");this.viewID=j();const a=o().cloneDeep(this.model.get("_data")),l=o().cloneDeep(this.model.get("_layout")),i=this.model.get("_config");r().newPlot(e.el,a,l,i).then((()=>{e._sendTraceDeltas(s),e._sendLayoutDelta(t),e.el.on("plotly_restyle",(t=>{e.handle_plotly_restyle(t)})),e.el.on("plotly_relayout",(t=>{e.handle_plotly_relayout(t)})),e.el.on("plotly_click",(t=>{e.handle_plotly_click(t)})),e.el.on("plotly_hover",(t=>{e.handle_plotly_hover(t)})),e.el.on("plotly_unhover",(t=>{e.handle_plotly_unhover(t)})),e.el.on("plotly_selected",(t=>{e.handle_plotly_selected(t)}));const a=new CustomEvent("plotlywidget-after-render",{detail:{element:e.el,viewID:e.viewID}});document.dispatchEvent(a)}))}processLuminoMessage(e){super.processLuminoMessage.apply(this,arguments);const t=this;switch(e.type){case"before-attach":var s={showgrid:!1,showline:!1,tickvals:[]};r().newPlot(t.el,[],{xaxis:s,yaxis:s}),window.addEventListener("resize",(()=>{t.autosizeFigure()}));break;case"after-attach":this.perform_render();break;case"resize":this.autosizeFigure()}}autosizeFigure(){const e=this,t=e.model.get("_layout");(o().isNil(t)||o().isNil(t.width))&&r().Plots.resize(e.el).then((()=>{const t=e.model.get("_last_layout_edit_id");e._sendLayoutDelta(t)}))}destroy(){r().purge(this.el)}getFullData(){return o().mergeWith({},this.el._fullData,this.el.data,p)}getFullLayout(){return o().mergeWith({},this.el._fullLayout,this.el.layout,p)}buildPointsObject(e){let t;if(e.hasOwnProperty("points")){const a=e.points,l=a.length;let o=!0;for(let e=0;e<l&&(o=o&&a[e].hasOwnProperty("pointNumbers"),o);e++);let i=l;if(o){i=0;for(let e=0;e<l;e++)i+=a[e].pointNumbers.length}if(t={trace_indexes:new Array(i),point_indexes:new Array(i),xs:new Array(i),ys:new Array(i)},o){let e=0;for(var s=0;s<l;s++)for(let l=0;l<a[s].pointNumbers.length;l++,e++)t.point_indexes[e]=a[s].pointNumbers[l],t.xs[e]=a[s].x,t.ys[e]=a[s].y,t.trace_indexes[e]=a[s].curveNumber;let o=!0;for(let e=1;e<i&&(o=o&&t.trace_indexes[e-1]===t.trace_indexes[e],o);e++);o&&t.point_indexes.sort(((e,t)=>e-t))}else for(s=0;s<l;s++)t.trace_indexes[s]=a[s].curveNumber,t.point_indexes[s]=a[s].pointNumber,t.xs[s]=a[s].x,t.ys[s]=a[s].y;if(void 0!==a[0]&&a[0].hasOwnProperty("z"))for(t.zs=new Array(l),s=0;s<l;s++)t.zs[s]=a[s].z;return t}return null}buildInputDeviceStateObject(e){const t=e.event;return void 0===t?null:{alt:t.altKey,ctrl:t.ctrlKey,meta:t.metaKey,shift:t.shiftKey,button:t.button,buttons:t.buttons}}buildSelectorObject(e){let t;return t=e.hasOwnProperty("range")?{type:"box",selector_state:{xrange:e.range.x,yrange:e.range.y}}:e.hasOwnProperty("lassoPoints")?{type:"lasso",selector_state:{xs:e.lassoPoints.x,ys:e.lassoPoints.y}}:null,t}handle_plotly_restyle(e){if(null==e)return;if(e[0]&&e[0].hasOwnProperty("_doNotReportToPy"))return;const t={style_data:e[0],style_traces:e[1],source_view_id:this.viewID};this.model.set("_js2py_restyle",t),this.touch()}handle_plotly_relayout(e){if(null==e)return;if(e.hasOwnProperty("_doNotReportToPy"))return;const t={relayout_data:e,source_view_id:this.viewID};this.model.set("_js2py_relayout",t),this.touch()}handle_plotly_update(e){if(null==e)return;if(e.data&&e.data[0].hasOwnProperty("_doNotReportToPy"))return;const t={style_data:e.data[0],style_traces:e.data[1],layout_data:e.layout,source_view_id:this.viewID};this.model.set("_js2py_update",t),this.touch()}handle_plotly_click(e){this._send_points_callback_message(e,"plotly_click")}handle_plotly_hover(e){this._send_points_callback_message(e,"plotly_hover")}handle_plotly_unhover(e){this._send_points_callback_message(e,"plotly_unhover")}handle_plotly_selected(e){this._send_points_callback_message(e,"plotly_selected")}handle_plotly_deselect(e){e={points:[]},this._send_points_callback_message(e,"plotly_deselect")}_send_points_callback_message(e,t){if(null==e)return;const s={event_type:t,points:this.buildPointsObject(e),device_state:this.buildInputDeviceStateObject(e),selector:this.buildSelectorObject(e)};null!=s.points&&(this.model.set("_js2py_pointsCallback",s),this.touch())}handle_plotly_doubleclick(e){}do_addTraces(){const e=this.model.get("_py2js_addTraces");if(null!==e){const t=this;r().addTraces(this.el,e.trace_data).then((()=>{t._sendTraceDeltas(e.trace_edit_id);const s=e.layout_edit_id;t._sendLayoutDelta(s)}))}}do_deleteTraces(){const e=this.model.get("_py2js_deleteTraces");if(null!==e){const t=e.delete_inds,s=this;r().deleteTraces(this.el,t).then((()=>{const t=e.trace_edit_id;s._sendTraceDeltas(t);const a=e.layout_edit_id;s._sendLayoutDelta(a)}))}}do_moveTraces(){const e=this.model.get("_py2js_moveTraces");if(null!==e){const t=e.current_trace_inds,s=e.new_trace_inds;o().isEqual(t,s)||r().moveTraces(this.el,t,s)}}do_restyle(){const e=this.model.get("_py2js_restyle");if(null!==e){const t=e.restyle_data,s=this.model._normalize_trace_indexes(e.restyle_traces);t._doNotReportToPy=!0,r().restyle(this.el,t,s),this._sendTraceDeltas(e.trace_edit_id);const a=e.layout_edit_id;this._sendLayoutDelta(a)}}do_relayout(){const e=this.model.get("_py2js_relayout");if(null!==e){e.source_view_id!==this.viewID&&(e.relayout_data._doNotReportToPy=!0,r().relayout(this.el,e.relayout_data));const t=e.layout_edit_id;this._sendLayoutDelta(t)}}do_update(){const e=this.model.get("_py2js_update");if(null!==e){const t=e.style_data||{},s=e.layout_data||{},a=this.model._normalize_trace_indexes(e.style_traces);t._doNotReportToPy=!0,r().update(this.el,t,s,a),this._sendTraceDeltas(e.trace_edit_id);const l=e.layout_edit_id;this._sendLayoutDelta(l)}}do_animate(){const e=this.model.get("_py2js_animate");if(null!==e){const t=e.animation_opts,s={data:e.style_data,layout:e.layout_data,traces:this.model._normalize_trace_indexes(e.style_traces),_doNotReportToPy:!0},a=this;r().animate(this.el,s,t).then((()=>{a._sendTraceDeltas(e.trace_edit_id);const t=e.layout_edit_id;a._sendLayoutDelta(t)}))}}_sendLayoutDelta(e){const t={layout_delta:v(this.getFullLayout(),this.model.get("_layout")),layout_edit_id:e};this.model.set("_js2py_layoutDelta",t),this.touch()}_sendTraceDeltas(e){const t=this.model.get("_data"),s=o().range(t.length),a=new Array(s.length),l=this.getFullData();for(let e=0;e<s.length;e++){const o=s[e];a[e]=v(l[o],t[o])}const i={trace_deltas:a,trace_edit_id:e};this.model.set("_js2py_traceDeltas",i),this.touch()}}const c={int8:Int8Array,int16:Int16Array,int32:Int32Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array};function u(e,t){let s;if(o().isTypedArray(e))s=function(e){let t;if(e instanceof Int8Array)t="int8";else if(e instanceof Int16Array)t="int16";else if(e instanceof Int32Array)t="int32";else if(e instanceof Uint8Array)t="uint8";else if(e instanceof Uint16Array)t="uint16";else if(e instanceof Uint32Array)t="uint32";else if(e instanceof Float32Array)t="float32";else{if(!(e instanceof Float64Array))return e;t="float64"}return{dtype:t,shape:[e.length],value:e.buffer}}(e);else if(Array.isArray(e)){s=new Array(e.length);for(let t=0;t<e.length;t++)s[t]=u(e[t])}else if(o().isPlainObject(e)){s={};for(const t in e)e.hasOwnProperty(t)&&(s[t]=u(e[t]))}else s=void 0===e?"_undefined_":e;return s}function h(e,t){let s;if(Array.isArray(e)){s=new Array(e.length);for(let t=0;t<e.length;t++)s[t]=h(e[t])}else if(o().isPlainObject(e))if((o().has(e,"value")||o().has(e,"buffer"))&&o().has(e,"dtype")&&o().has(e,"shape"))s=new(0,c[e.dtype])(o().has(e,"value")?e.value.buffer:e.buffer.buffer);else{s={};for(const t in e)e.hasOwnProperty(t)&&(s[t]=h(e[t]))}else s="_undefined_"===e?void 0:e;return s}function p(e,t,s){return"_"===s[0]?null:(a=t,!ArrayBuffer.isView(a)||a instanceof DataView?void 0:t);var a}function f(e,t){for(const s in t){if(!t.hasOwnProperty(s))continue;const a=t[s];null===a?o().unset(e,s):o().set(e,s,a)}}function m(e,t,s){for(const a in t){if(!t.hasOwnProperty(a))continue;let l=t[a];Array.isArray(l)||(l=[l]);for(let t=0;t<s.length;t++){const i=e[s[t]],r=l[t%l.length];null===r?o().unset(i,a):void 0!==r&&o().set(i,a,r)}}}function g(e,t){for(let s=0;s<t.length;s++){const a=t[s];o().unset(e,a)}}function v(e,t){let s;s=Array.isArray(e)?new Array(e.length):{},null==t&&(t={});for(const a in e)if("_"!==a[0]&&e.hasOwnProperty(a)&&null!==e[a]&&(!o().isEqual(e[a],t[a])||"uid"===a)){const l=e[a];if(t.hasOwnProperty(a)&&"object"==typeof l)if(Array.isArray(l))if(l.length>0&&"object"==typeof l[0]){s[a]=new Array(l.length);for(let e=0;e<l.length;e++)!Array.isArray(t[a])||t[a].length<=e?s[a][e]=l[e]:s[a][e]=v(l[e],t[a][e])}else s[a]=l;else{const e=v(l,t[a]);Object.keys(e).length>0&&(s[a]=e)}else"object"!=typeof l||Array.isArray(l)?void 0!==l&&"function"!=typeof l&&(s[a]=l):s[a]=v(l,{})}return s}function j(e,t,s,a){if(s||(s=16),void 0===t&&(t=24),t<=0)return"0";let l,o,i,r=Math.log(Math.pow(2,t))/Math.log(s),n="";for(l=2;r===1/0;l*=2)r=Math.log(Math.pow(2,t/l))/Math.log(s)*l;const _=r-Math.floor(r);for(l=0;l<Math.floor(r);l++)i=Math.floor(Math.random()*s).toString(s),n=i+n;_&&(o=Math.pow(s,_),i=Math.floor(Math.random()*o).toString(s),n=i+n);const d=parseInt(n,s);return e&&e[n]||d!==1/0&&d>=Math.pow(2,t)?a>10?(console.warn("randstr failed uniqueness"),n):j(e,t,s,(a||0)+1):n}}}]);