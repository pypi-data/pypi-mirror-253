import{d as j,i as B,b as g,k as ie,c as h,o as $,e as x,f as n,t as T,m as q,_ as F,U as re,r as E,V as P,H as L,W as A,R as G,X as de,I as ue,w as X,v as Y,h as pe,F as _e,s as ve,n as J,p as Q,j as Z,z as me,l as fe,q as ge,S as he}from"./index-b496a7a6.js";const ye={class:"ChildlessPlaceholder"},Ce={class:"content"},be={class:"title"},Ie={key:0,class:"message"},Pe=10,Se=j({__name:"ChildlessPlaceholder",props:{componentId:{}},setup(p){const a=p,i=B(g.core),{componentId:l}=ie(a),s=h(()=>i.getComponentById(l.value)),S=h(()=>i.getComponentDefinition(s.value.type)),m=(C,b)=>{const e=C.map(c=>i.getComponentDefinition(c)).map(c=>c==null?void 0:c.name);return`${e.slice(0,-1).join(", ")} ${e.length>1?b:""} ${e.at(-1)}`},_=h(()=>{const C=i.getContainableTypes(l.value);let b;return C.length<=Pe&&(b=`You can add ${m(C,"and")} components`),b});return(C,b)=>($(),x("div",ye,[n("div",Ce,[n("div",be,[n("h2",null,"Empty "+T(S.value.name),1)]),_.value?($(),x("div",Ie,T(_.value),1)):q("",!0)])]))}});const $e=F(Se,[["__scopeId","data-v-b958fd6f"]]),Ee={props:["componentId","instancePath","instanceData"],setup(p){const a=B(g.core),i=B(g.builderManager),l=p.componentId,s=h(()=>a.getComponentById(l)),S=re(s.value.type),m=p.instancePath,_=p.instanceData,{getEvaluatedFields:C,isComponentVisible:b}=G(a),r=C(m),e=h(()=>a.getComponents(l,!0)),d=h(()=>!!i&&i.getMode()!="preview"),c=E(!1),V=h(()=>a.getUserFunctions()),w=()=>{if(!(e.value.length>0))return A($e,{componentId:s.value.id})},M=(t,o=0)=>A(ee,{componentId:t,key:`${t}:${o}`,instancePath:[...m,{componentId:t,instanceNumber:o}],instanceData:[..._,E(null)]}),K=(t=0,o=()=>!0,f=!1)=>{const v=y=>A("div",{"data-streamsync-slot-of-id":l,"data-streamsync-position":y}),u=d.value&&!f,I=e.value.filter(o).map((y,D)=>[M(y.id,t),...u?[v(D+1)]:[]]);return[...u?[v(0)]:[]].concat(I.flat())},W=(t=>t.map(o=>`${o.componentId}:${o.instanceNumber}`).join(","))(m);P(g.evaluatedFields,r),P(g.componentId,l),P(g.isBeingEdited,d),P(g.isDisabled,c),P(g.instancePath,m),P(g.instanceData,_),P(g.renderProxiedComponent,M),P(g.getChildrenVNodes,K),P(g.flattenedInstancePath,W);const te={"data-streamsync-id":l,"data-streamsync-instance-path":W},k=E(!1);L(()=>(i==null?void 0:i.getSelectedId())==l,t=>{k.value=t}),L(()=>r,()=>{k.value=!1},{deep:!0});const z=h(()=>e.value.length==0),se=h(()=>b(l,m)),ne=(t,o)=>{if(!t.startsWith("$")&&!o)return v=>{let u=!1;V.value.some(I=>I.name==t&&I.args.includes("payload"))&&(u=!0),a.forwardEvent(v,m,u)};if(t.startsWith("$goToPage_")){const v=t.substring(10);return u=>a.setActivePageFromKey(v)}return null},oe=h(()=>{const t={},o=Object.keys(s.value.handlers??{}),f=s.value.binding?[s.value.binding.eventType]:[];return Array.from(new Set([...o,...f])).forEach(u=>{var D;const I=`on${u.charAt(0).toUpperCase()}${u.slice(1)}`,y=u===((D=s.value.binding)==null?void 0:D.eventType);t[I]=N=>{var O,U;y&&a.forwardEvent(N,m,!0);const H=(O=s.value.handlers)==null?void 0:O[u];H&&((U=ne(H,y))==null||U(N))}}),t}),ae=h(()=>{var f;const t=(f=a.getComponentDefinition(s.value.type))==null?void 0:f.fields;if(!t)return;const o={};return Object.keys(t).forEach(v=>{t[v].applyStyleVariable&&r[v]&&(o[`--${v}`]=r[v].value)}),o}),le=h(()=>{var I;const t="cssClasses",o=(I=a.getComponentDefinition(s.value.type))==null?void 0:I.fields;if(!o||!o[t]||!r[t])return;const f=r[t].value,v=f==null?void 0:f.split(" ").map(y=>y.trim()),u={};return v.forEach(y=>{u[y]=!0}),u}),ce=function(){return{class:{component:!0,childless:z.value,selected:k.value,disabled:c.value,...le.value},style:{...ae.value,...se.value?{}:{display:"none"}},...te,...c.value?[]:oe.value,draggable:d.value}};return()=>{const t=d.value?w():void 0,o=({instanceNumber:u=0,componentFilter:I=()=>!0,positionlessSlot:y=!1})=>z.value?y?void 0:t:K(u,I,y),f={...ce()};return A(S,f,{default:o})}}};const ee=F(Ee,[["__scopeId","data-v-9d41162e"]]),R=p=>(Q("data-v-cbbb395f"),p=p(),Z(),p),Te=R(()=>n("i",{class:"ri-notification-2-line ri-xl"},null,-1)),xe={class:"counter"},Me=R(()=>n("div",{class:"balloonFlash"},null,-1)),De={class:"main"},Be=R(()=>n("i",{class:"ri-close-line"},null,-1)),Ve=R(()=>n("i",{class:"ri-error-warning-fill ri-xl"},null,-1)),we=[Ve],Ae={class:"content"},Fe={class:"title"},Re={class:"time"},ke={class:"message"},Ne=100,Le=j({__name:"RendererNotifications",setup(p){const a=B(g.core),i=E(!1),l=E(null),s=de([]),S=C=>{const{type:b,title:r,message:e,code:d}=C;s.unshift({type:b,title:r,message:e,code:d,timestampReceived:new Date}),s.splice(Ne),l.value.classList.remove("alert"),l.value.offsetWidth,l.value.classList.add("alert")};ue(()=>{a.addMailSubscription("notification",S)});const m=()=>{s.length!=0&&(i.value=!i.value)},_=()=>{s.splice(0),i.value=!1};return(C,b)=>X(($(),x("div",{class:"RendererNotifications",onClick:m},[n("div",{class:"balloon",ref_key:"balloon",ref:l,title:"Toggle notifications"},[Te,n("div",xe,T(s.length),1)],512),Me,X(n("div",De,[n("div",{class:"clearContainer"},[n("button",{onClick:_},[Be,pe(" Clear all ")])]),($(!0),x(_e,null,ve(s,(r,e)=>($(),x("div",{class:"notification",key:e},[n("div",{class:J(["icon",r.type])},we,2),n("div",Ae,[n("header",null,[n("strong",Fe,T(r.title),1),n("span",Re,T(r.timestampReceived.toLocaleTimeString()),1)]),n("div",ke,T(r.message),1)])]))),128))],512),[[Y,i.value]])],512)),[[Y,s.length>0]])}});const je=F(Le,[["__scopeId","data-v-cbbb395f"]]),Ke=p=>(Q("data-v-36807a14"),p=p(),Z(),p),We=Ke(()=>n("div",{class:"loadingBar"},null,-1)),ze={class:"rootComponentArea"},He=j({__name:"ComponentRenderer",setup(p){const a=B(g.core),i=G(a),l=a.getComponents();l.length==0&&console.error("No pages found.");const s=[{componentId:"root",instanceNumber:0}],S=[E(null)],m=E(l[0]),_=i.getEvaluatedFields(s),C=h(()=>{var e,d,c,V,w,M;return{"--accentColor":(e=_.accentColor)==null?void 0:e.value,"--emptinessColor":(d=_.emptinessColor)==null?void 0:d.value,"--containerBackgroundColor":(c=_.parentIdBackgroundColor)==null?void 0:c.value,"--primaryTextColor":(V=_.primaryTextColor)==null?void 0:V.value,"--secondaryTextColor":(w=_.secondaryTextColor)==null?void 0:w.value,"--separatorColor":(M=_.separatorColor)==null?void 0:M.value}}),b=h(()=>a.getFrontendMessageMap().size>0);L(()=>{var e;return(e=_.appName)==null?void 0:e.value},e=>{r(e)},{immediate:!0});function r(e){const d=a.getMode();let c;e&&d=="edit"?c=`${e} | Streamsync Builder`:!e&&d=="edit"?c="Streamsync Builder":e&&d=="run"?c=`${e}`:!e&&d=="run"&&(c="Streamsync App"),document.title=c}return(e,d)=>($(),x("main",{class:J(["ComponentRenderer",{loadingActive:b.value}]),tabindex:"-1",style:he(C.value)},[me(je,{class:"notifications"}),We,n("div",ze,[m.value?($(),fe(ee,{key:0,"component-id":m.value.id,"instance-path":s,"instance-data":S},null,8,["component-id"])):q("",!0),ge(e.$slots,"default",{},void 0,!0)])],6))}});const Xe=F(He,[["__scopeId","data-v-36807a14"]]);export{Xe as default};
