import pyrsakeyutils.rsautil as r


def test_read():
    bs = b'''-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAy5K6aLNKyzTDgUyUJ9E2GsLP0mkslePsAgt22xCzt5EVFCWM
R9k37L+A2cE0iirSWdpU67f7agiJQ0mSfSb7btpY+OxvALmIjDZPGed3dFrYbxOM
QOD/vcGm7Fb4UDc5OYSp59m8kEW5rbGTFVz38FfIwPDZ9Q8it7hFKEzwDm5IRjtT
sRX2yQ30ZkZxSFJ6IGzzr9R+5mt5A8+yZs0afT9QLH4VjHSxxDVoTLNrwXg1lQYD
FRhfQ1y4LecvpApWVS/U8ovLxqAbOqJVsiQ0j0V3uvKfDpHMnzSOQPQt6CBN+AmH
82sO3q9zdeVgK+R9pIv+owYzEczqHKXXLfBQzwIDAQABAoIBAE84qpJUM6cgwXRv
+LgGEqgXaAjaJR+vswiYrYhS1514OFu+wPi0766SV/Jl3axnPbT54lJZJt38tG4b
E4bgxLg/AKDeYdRGX30xJVdPXI1LTS7szIfzB5Mw6WTP85JD62EW34f6lAcRG1Ec
6cBGjbZacyWilS9o1Hnqm/8y8birQFBh9tmrIsZIpr8siMoeKibLfhZI9gCacagD
C9XYbByojplRUmVOAu4Adi/xVUvLMNGTIQIWHS8Smh/QI6iseqdyovUWCA3oYVUx
yD5xLgmXUpuUFsDuT7Cu9l5h9S3Eo7KmjO9y1eWbx+saUUp3WdkPSsKh/hUbK0RZ
qhm1cQECgYEA78Ajb9rQj2HlkZcOYzxo1D5X/nR9ZHgU9mMFPd91afYGSfwS2q73
mD4vphFNl0+RLWOdepCMgPMk3mJSddI3f4CvdsHOjmZ3LZ8Clx3E23NPQKXlgikL
S9p3IWI7nmzXiYW+l1elxrhSZuCIuclS7alfHT4wkykvAVxw9zVk7DUCgYEA2V7i
LR2O/tYuCW+gsAcGWlmshHiem8fJ9ep1x3iGPpw2++RLUCilfSMOtdyRI8+wdhPR
YXBmS3iID0BleVRkT7ljCKwm8dpfs36GEuS9VfMdcLWWFUxCj+AOTEtddpdKhO91
qgs7HDh+o806o3I4i6QJgnVouqhxlEdiV0O2AXMCgYEAl3ofKannwd/Jiw4UshBV
71ugfw2cuCDCpdV0V15bMeKWoKIaS37mwpLvyg3+pw5HnJTmx6ySiVqWPceDcBus
outscS0MU55byEBCA7Z0TW7ycNcgRfemwns6b6ZAIt2D5MjS3Y4sGH0W2xcca73O
nog3pyNGz4Pixgpg+WAL7s0CgYEAsHVYQqumM7YHNV3LIlrxi1MUu413pJqxltK4
vi9XO2hxMlcH1JDKlyVogbYGlP27EH/SD7nBMS8ttMPgHHin3hhvDtFB5EAURJBH
ovrRwP5VPfQLXErGFiobMVBVFTqIIhaKfHoViDlMhQjLu3ez85g8qA1L8YtgeLDi
YljzXYUCgYBD1vUgda59jHAJwFYzgfPiwPSfKF+Za1nFD49OKUIM7f5MyHV47LrL
fjq5a7x3huxIqzyUztWlNgQRG17s0NnPdNE0dKxBxkM8Jfs3fka8N/ziDH1RNV/D
pEE9HgkZh4M6r4I2TX2NLA0HiuHhVnJA8dfyes11zScGwRIZ2pjiBQ==
-----END RSA PRIVATE KEY-----'''    
    pub = r.from_private(bs)
    print(pub)
    assert pub.__repr__() == '{"modulus": 25698730260539204524478716754401709165717143109431848240697072432808146502102485258328635356354931069585018829337747293707452408114710630102835777615404439558563430025251530769774390972714565848824885636111559976918998158451735372098427759453958141149908567219938323496181576977056246617666445477498093914719391098210749107712013775123629369161794578745207363341916610357935668592807365386741627672912136332676675024028260225888859546779636532300854264331100559942888026743901830066727882633152510003425959192099864719677524114303701660011978377087126295688823270572637557274908223704933581404982844196557629873475791, "exponent": 65537}'
